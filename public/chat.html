<html>

<head>
  <title>Chat</title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/core-js/2.1.4/core.min.js"></script>
  <script src="//npmcdn.com/feathers-client@^1.0.0/dist/feathers.js"></script>
  <script src="socket.io/socket.io.js"></script>
</head>

<body>
  <script type="text/javascript">
    // Establish a Socket.io connection to the local server
    var socket = io();
    
    // Create a client side Feathers application that uses the socket
    // for connecting to services
    var app = feathers();
    app.configure(feathers.socketio(socket));
    app.configure(feathers.hooks())
    app.configure(feathers.authentication())
    
    app.authenticate()
    
    // Retrieve a connection to the /messages service on the server
    // This service will use websockets for all communication
    var messages = app.service('messages');

    // Listen for when a new message has been created
    messages.on('created', function(message) {
      //console.log('Someone created a message', message);
      document.getElementById('messages').innerHTML += '<p>' + message.text + '</p>'
    });

    // Create a new message on the service
    //messages.create({ text: 'Hello from websocket!' });

    function submit() {
      var domMessage = document.getElementById('message')
      if(domMessage.value) {
        messages.create({ text: domMessage.value })
        domMessage.value = ''
      }
    }

  </script>
  <div id="messages"></div>
  <div style="position: absolute; top: 90%; left: 0%">
    <input id="message" type="text" />&nbsp;
    <button onclick="submit()">Send</button>
  </div>
</body>

</html>